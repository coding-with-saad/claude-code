{{/*
NOTE: This file validates secret existence only.
The secret must be created manually BEFORE Helm install.

Create with:
kubectl create secret generic {{ .Values.secretName }} \
  --namespace={{ .Values.namespace }} \
  --from-literal=DATABASE_URL='postgresql://...' \
  --from-literal=API_KEY='...' \
  --from-literal=OTHER_SECRET='...'

For more details, see: references/secret-management.md
*/}}

{{- $secretName := .Values.secretName }}
{{- $secret := (lookup "v1" "Secret" .Values.namespace $secretName) }}
{{- if and (not $secret) .Release.IsInstall }}
{{- fail (printf "Secret '%s' must be created in namespace '%s' before installing. See templates/secret.yaml for instructions." $secretName .Values.namespace) }}
{{- end }}
